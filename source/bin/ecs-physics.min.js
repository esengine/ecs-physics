window.physics={},window.__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();var __values=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}};!function(t){var e=function(){function t(){}return t.USE_ACTIVE_CONTACT_SET=!1,t}();t.Defined=e}(physics||(physics={})),function(t){!function(t){t[t.none=0]="none",t[t.all=Number.MAX_VALUE]="all",t[t.cat1=1]="cat1",t[t.cat2=2]="cat2",t[t.cat3=4]="cat3",t[t.cat4=8]="cat4",t[t.cat5=16]="cat5",t[t.cat6=32]="cat6",t[t.cat7=64]="cat7",t[t.cat8=128]="cat8",t[t.cat9=256]="cat9",t[t.cat10=512]="cat10",t[t.cat11=1024]="cat11",t[t.cat12=2048]="cat12",t[t.cat13=4096]="cat13",t[t.cat14=8192]="cat14",t[t.cat15=16384]="cat15",t[t.cat16=32768]="cat16",t[t.cat17=65536]="cat17",t[t.cat18=131072]="cat18",t[t.cat19=262144]="cat19",t[t.cat20=524288]="cat20",t[t.cat21=1048576]="cat21",t[t.cat22=2097152]="cat22",t[t.cat23=4194304]="cat23",t[t.cat24=8388608]="cat24",t[t.cat25=16777216]="cat25",t[t.cat26=33554432]="cat26",t[t.cat27=67108864]="cat27",t[t.cat28=134217728]="cat28",t[t.cat29=268435456]="cat29",t[t.cat30=536870912]="cat30",t[t.cat31=1073741824]="cat31"}(t.Category||(t.Category={}));var e=function(){return function(){}}();t.FixtureProxy=e;var i=function(){function i(e,o,n){void 0===n&&(n=null),this.body=e,this.userData=n,this.shape=o.clone(),this.fixtureId=i._fixtureIdCounter++,this._collisonCategories=t.Settings.defaultFixtureCollisionCategories,this._collidesWith=t.Settings.defaultFixtureCollidesWith,this._collisionGroup=0,this._colisionIgnores=new Set,this.ignoreCCDWith=t.Settings.defaultFixtureIgnoreCCDWith,this.friction=.2,this.restitution=0}return Object.defineProperty(i.prototype,"collisionGroup",{get:function(){return this._collisionGroup},set:function(t){this._collisionGroup!=t&&(this._collisionGroup=t,this.refilter())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"collidesWith",{get:function(){return this._collidesWith},set:function(t){this._collidesWith!=t&&(this._collidesWith=t,this.refilter())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"collisionCategories",{get:function(){return this._collisonCategories},set:function(t){this._collisonCategories!=t&&(this._collisonCategories=t,this.refilter())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSensor",{get:function(){return this._isSensor},set:function(t){null!=this.body&&(this.body.isAwake=!0),this._isSensor=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"friction",{get:function(){return this._friction},set:function(t){console.assert(!Number.isNaN(t)),this._friction=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"restitution",{get:function(){return this._restitution},set:function(t){console.assert(!Number.isNaN(t)),this._restitution=t},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this.isDisposed},i.prototype.restoreCollisionWith=function(t){this._colisionIgnores.has(t.fixtureId)&&(this._colisionIgnores.delete(t.fixtureId),this.refilter())},i.prototype.ignoreCollisionWith=function(t){this._colisionIgnores.has(t.fixtureId)||(this._colisionIgnores.add(t.fixtureId),this.refilter())},i.prototype.isFixtureIgnored=function(t){return this._colisionIgnores.has(t.fixtureId)},i.prototype.refilter=function(){for(var t=this.body.contactList;null!=t;){var e=t.contact,i=e.fixtureA,o=e.fixtureB;i!=this&&o!=this||(e.filterFlag=!0),t=t.next}var n=this.body._world;if(null!=n)for(var s=n.contactManager.broadPhase,r=0;r<this.proxyCount;++r)s.touchProxy(this.proxies[r].proxyId)},i.prototype.registerFixture=function(){var t=this;if(this.proxies=[],this.proxyCount=0,this.body.enabled){var e=this.body._world.contactManager.broadPhase;this.createProxies(e,this.body._xf)}this.body.fixtureList.push(this),this.shape._density>0&&this.body.resetMassData(),this.body._world._worldHasNewFixture=!0,null!=this.body._world.onFixtureAdded&&this.body._world.onFixtureAdded.forEach(function(e){return e(t)})},i.prototype.rayCast=function(t,e,i){return this.shape.rayCast(t,e,this.body._xf,i)},i.prototype.destroy=function(){var e=this;this.shape.shapeType==t.ShapeType.polygon&&(this.shape.vertices.attackedToBody=!1),console.assert(0==this.proxyCount),this.proxies=null,this.shape=null,this.userData=null,this.beforeCollision=null,this.onCollision=null,this.onSeperation=null,this.afterCollision=null,null!=this.body._world.onFixtureRemoved&&this.body._world.onFixtureRemoved.forEach(function(t){return t(e)}),this.body._world.onFixtureAdded=null,this.body._world.onFixtureRemoved=null,this.onSeperation=null,this.onCollision=null},i.prototype.createProxies=function(t,i){console.assert(0==this.proxyCount),this.proxyCount=this.shape.childCount;for(var o=0;o<this.proxyCount;++o){var n=new e;this.shape.computeAABB(n.aabb,i,o),n.fixture=this,n.childIndex=o,n.proxyId=t.addProxy(n),this.proxies[o]=n}},i.prototype.destroyProxies=function(t){for(var e=0;e<this.proxyCount;++e)t.removeProxy(this.proxies[e].proxyId),this.proxies[e].proxyId=-1;this.proxyCount=0},i}();t.Fixture=i}(physics||(physics={})),function(t){var e=function(){function e(){}return e.mixFriction=function(t,e){return Math.sqrt(t*e)},e.mixRestitution=function(t,e){return t>e?t:e},e.maxFloat=3.402823466e38,e.epsilon=1.192092896e-7,e.pi=3.14159265359,e.enableDiagnostics=!0,e.defaultFixtureCollisionCategories=t.Category.cat1,e.defaultFixtureCollidesWith=t.Category.all,e.defaultFixtureIgnoreCCDWith=t.Category.none,e.aabbExtension=.1,e.linearSlop=.005,e.polygonRadius=2*e.linearSlop,e.maxPolygonVertices=8,e.useConvexHullPolygons=!0,e.maxGJKIterations=20,e}();t.Settings=e}(physics||(physics={})),function(t){var e=function(){return function(){}}();t.RayCastInput=e;var i=function(){return function(){}}();t.RayCastOutput=i,function(t){t[t.circles=0]="circles",t[t.faceA=1]="faceA",t[t.faceB=2]="faceB"}(t.ManifoldType||(t.ManifoldType={}));var o=function(){return function(){}}();t.Manifold=o;var n=function(){return function(){}}();t.ManifoldPoint=n;var s=function(){return function(){}}();t.ContactID=s;var r=function(){return function(){}}();t.ContactFeature=r;var a=function(){function e(t,e){void 0===t&&(t=new es.Vector2),void 0===e&&(e=new es.Vector2),this.lowerBound=t,this.upperBound=e}return Object.defineProperty(e.prototype,"width",{get:function(){return this.upperBound.x-this.lowerBound.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.upperBound.y-this.lowerBound.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return this.lowerBound.add(this.upperBound).scale(.5)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extents",{get:function(){return this.upperBound.sub(this.lowerBound).scale(.5)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perimeter",{get:function(){return 2*(this.upperBound.x-this.lowerBound.x+(this.upperBound.y-this.lowerBound.y))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertices",{get:function(){var e=new t.Vertices;return e.push(this.upperBound),e.push(new es.Vector2(this.upperBound.x,this.lowerBound.y)),e.push(this.lowerBound),e.push(new es.Vector2(this.lowerBound.x,this.upperBound.y)),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"q1",{get:function(){return new e(this.center,this.upperBound)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"q2",{get:function(){return new e(new es.Vector2(this.lowerBound.x,this.center.y),new es.Vector2(this.center.x,this.upperBound.y))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"q3",{get:function(){return new e(this.lowerBound,this.center)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"q4",{get:function(){return new e(new es.Vector2(this.center.x,this.lowerBound.y),new es.Vector2(this.upperBound.x,this.center.y))},enumerable:!0,configurable:!0}),e.prototype.isValid=function(){var t=this.upperBound.sub(this.lowerBound),e=t.x>=0&&t.y>=0;return e=e&&this.lowerBound.isValid()&&this.upperBound.isValid()},e.prototype.combine=function(t){this.lowerBound=es.Vector2.min(this.lowerBound,t.lowerBound),this.upperBound=es.Vector2.max(this.upperBound,t.upperBound)},e.prototype.combine2=function(t,e){this.lowerBound=es.Vector2.min(t.lowerBound,e.lowerBound),this.upperBound=es.Vector2.max(t.upperBound,e.upperBound)},e.prototype.contains=function(t){var e=!0;return e=(e=(e=(e=e&&this.lowerBound.x<=t.lowerBound.x)&&this.lowerBound.y<=t.lowerBound.y)&&t.upperBound.x<=this.upperBound.x)&&t.upperBound.y<=this.upperBound.y},e.testOverlap=function(t,e){var i=e.lowerBound.sub(t.upperBound),o=t.lowerBound.sub(e.upperBound);return!(i.x>0||i.y>0)&&!(o.x>0||o.y>0)},e}();t.AABB=a;var h=function(){function e(){}return e.testOverlap=function(e,i,o,n,s,r){this._input=this._input?this._input:new t.DistanceInput,this._input.proxyA.set(e,i),this._input.proxyB.set(o,n),this._input.transformA=s,this._input.transformB=r,this._input.useRadii=!0;new t.SimplexCache;var a=new t.DistanceOutput;return t.Distance.computeDistance(a,this._input),a.distance<10*t.Settings.epsilon},e}();t.Collision=h}(physics||(physics={})),function(t){var e=function(){function e(){this.vertices=new t.Vertices}return e.prototype.set=function(e,i){switch(e.shapeType){case t.ShapeType.circle:var o=e;this.vertices.length=0,this.vertices.push(o.position),this.radius=o.radius;break;case t.ShapeType.polygon:var n=e;this.vertices.length=0;for(var s=0;s<n.vertices.length;s++)this.vertices.push(n.vertices[s]);this.radius=n.radius;break;case t.ShapeType.chain:var r=e;console.assert(0<=i&&i<r.vertices.length),this.vertices.length=0,this.vertices.push(r.vertices[i]),this.vertices.push(i+1<r.vertices.length?r.vertices[i+1]:r.vertices[0]),this.radius=r.radius;break;case t.ShapeType.edge:var a=e;this.vertices.length=0,this.vertices.push(a.vertex1),this.vertices.push(a.vertex2),this.radius=a.radius;break;default:console.assert(!1)}},e}();t.DistanceProxy=e;var i=function(){function e(){this.count=0}return e.prototype.readCache=function(e,i,o,n,s){console.assert(e.count<=3),this.count=e.count;for(var r=0;r<this.count;++r){(l=this.v.get(r)).indexA=e.indexA[r],l.indexB=e.indexB[r];var a=i.vertices[l.indexA],h=n.vertices[l.indexB];l.wA=t.MathUtils.mul(o,a),l.wB=t.MathUtils.mul(s,h),l.w=l.wB.sub(l.wA),l.a=0,this.v[r]=l}if(this.count>1){var c=e.metric,u=this.getMetric();(u<.5*c||2*c<u||u<t.Settings.epsilon)&&(this.count=0)}if(0==this.count){var l;(l=this.v.get(0)).indexA=0,l.indexB=0;a=i.vertices[0],h=n.vertices[0];l.wA=t.MathUtils.mul(o,a),l.wB=t.MathUtils.mul(s,h),l.w=l.wB.sub(l.wA),l.a=1,this.v.set(0,l),this.count=1}},e.prototype.getMetric=function(){switch(this.count){case 0:return console.assert(!1),0;case 1:return 0;case 2:return this.v.get(0).w.sub(this.v.get(1).w).magnitude();case 3:return t.MathUtils.cross(this.v.get(1).w.sub(this.v.get(0).w),this.v.get(2).w.sub(this.v.get(0).w));default:return console.assert(!1),0}},e}(),o=function(){function e(){}return e.computeDistance=function(e,o){var n=new r;t.Settings.enableDiagnostics&&++this.gjkCalls;var s=new i;s.readCache(n,o.proxyA,o.transformA,o.proxyB,o.transformB);for(var a=new t.FixedArray3,h=new t.FixedArray3;0<t.Settings.maxGJKIterations;){for(var c=s.count,u=0;u<c;++u)a.set(u,s.v.get(u).indexA),h.set(u,s.v.get(u).indexB);switch(s.count){case 1:case 2:case 3:break;default:console.assert(!1)}if(3==s.count)break}return n},e}();t.Distance=o;var n=function(){return function(){this.proxyA=new e,this.proxyB=new e}}();t.DistanceInput=n;var s=function(){return function(){}}();t.DistanceOutput=s;var r=function(){return function(){}}();t.SimplexCache=r}(physics||(physics={})),function(t){var e=function(){function t(){}return t.prototype.isLeaf=function(){return this.child1==i.nullNode},t}();t.TreeNode=e;var i=function(){function i(){this._raycastStack=[],this._queryStack=[],this._root=i.nullNode,this._nodeCapacity=16,this._nodeCount=0,this._nodes=[];for(var t=0;t<this._nodeCapacity-1;++t)this._nodes[t]=new e,this._nodes[t].parentOrNext=t+1,this._nodes[t].height=1;this._nodes[this._nodeCapacity-1]=new e,this._nodes[this._nodeCapacity-1].parentOrNext=i.nullNode,this._nodes[this._nodeCapacity-1].height=1,this._freeList=0}return Object.defineProperty(i.prototype,"height",{get:function(){return this._root==i.nullNode?0:this._nodes[this._root].height},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"areaRatio",{get:function(){if(this._root==i.nullNode)return 0;for(var t=this._nodes[this._root].aabb.perimeter,e=0,o=0;o<this._nodeCapacity;++o){var n=this._nodes[o];n.height<0||(e+=n.aabb.perimeter)}return e/t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxBalance",{get:function(){for(var t=0,e=0;e<this._nodeCapacity;++e){var i=this._nodes[e];if(!(i.height<=1)){console.assert(0==i.isLeaf());var o=i.child1,n=i.child2,s=Math.abs(this._nodes[n].height-this._nodes[o].height);t=Math.max(t,s)}}return t},enumerable:!0,configurable:!0}),i.prototype.addProxy=function(e,i){var o=this.allocateNode(),n=new es.Vector2(t.Settings.aabbExtension,t.Settings.aabbExtension);return this._nodes[o].aabb.lowerBound=e.lowerBound.sub(n),this._nodes[o].aabb.upperBound=e.upperBound.add(n),this._nodes[o].userData=i,this._nodes[o].height=0,this.insertLeaf(o),o},i.prototype.removeProxy=function(t){console.assert(0<=t&&t<this._nodeCapacity),console.assert(this._nodes[t].isLeaf()),this.removeLeaf(t),this.freeNode(t)},i.prototype.moveProxy=function(e,i,o){if(console.assert(0<=e&&e<this._nodeCapacity),console.assert(this._nodes[e].isLeaf()),this._nodes[e].aabb.contains(i))return!1;this.removeLeaf(e);var n=i,s=new es.Vector2(t.Settings.aabbExtension,t.Settings.aabbExtension);n.lowerBound=n.lowerBound.sub(s),n.upperBound=n.upperBound.add(s);var r=o.scale(t.Settings.aabbExtension);return r.x<0?n.lowerBound.x+=r.x:n.upperBound.x+=r.x,r.y<0?n.lowerBound.y+=r.y:n.upperBound.y+=r.y,this._nodes[e].aabb=n,this.insertLeaf(e),!0},i.prototype.getUserData=function(t){return console.assert(0<=t&&t<this._nodeCapacity),this._nodes[t].userData},i.prototype.getFatAABB=function(t){return console.assert(0<=t&&t<this._nodeCapacity),this._nodes[t].aabb},i.prototype.allocateNode=function(){if(this._freeList==i.nullNode){console.assert(this._nodeCount==this._nodeCapacity);var o=this._nodes;this._nodeCapacity*=2,this._nodes=o.slice(0,this._nodeCount);for(var n=this._nodeCount;n<this._nodeCapacity-1;++n)this._nodes[n]=new e,this._nodes[n].parentOrNext=n+1,this._nodes[n].height=-1;this._nodes[this._nodeCapacity-1]=new e,this._nodes[this._nodeCapacity-1].parentOrNext=i.nullNode,this._nodes[this._nodeCapacity-1].height=-1,this._freeList=this._nodeCount}var s=this._freeList;return this._freeList=this._nodes[s].parentOrNext,this._nodes[s].parentOrNext=i.nullNode,this._nodes[s].child1=i.nullNode,this._nodes[s].child2=i.nullNode,this._nodes[s].height=0,this._nodes[s].userData=new t.FixtureProxy,++this._nodeCount,s},i.prototype.freeNode=function(t){console.assert(0<=t&&t<this._nodeCapacity),console.assert(0<this._nodeCount),this._nodes[t].parentOrNext=this._freeList,this._nodes[t].height=-1,this._freeList=t,--this._nodeCount},i.prototype.insertLeaf=function(e){if(this._root==i.nullNode)return this._root=e,void(this._nodes[this._root].parentOrNext=i.nullNode);for(var o=this._nodes[e].aabb,n=this._root;0==this._nodes[n].isLeaf();){var s=this._nodes[n].child1,r=this._nodes[n].child2,a=this._nodes[n].aabb.perimeter,h=new t.AABB;h.combine2(this._nodes[n].aabb,o);var c=h.perimeter,u=2*c,l=2*(c-a),p=0;if(this._nodes[s].isLeaf()){(y=new t.AABB).combine2(o,this._nodes[s].aabb),p=y.perimeter+l}else{(y=new t.AABB).combine2(o,this._nodes[s].aabb);var d=this._nodes[s].aabb.perimeter;p=y.perimeter-d+l}var f=0;if(this._nodes[r].isLeaf()){(y=new t.AABB).combine2(o,this._nodes[r].aabb),f=y.perimeter+l}else{var y;(y=new t.AABB).combine2(o,this._nodes[r].aabb);d=this._nodes[r].aabb.perimeter;f=y.perimeter-d+l}if(u<p&&p<f)break;n=p<f?s:r}var _=n,v=this._nodes[_].parentOrNext,g=this.allocateNode();for(this._nodes[g].parentOrNext=v,this._nodes[g].userData=new t.FixtureProxy,this._nodes[g].aabb.combine2(o,this._nodes[_].aabb),this._nodes[g].height=this._nodes[_].height+1,v!=i.nullNode?(this._nodes[v].child1==_?this._nodes[v].child1=g:this._nodes[v].child2=g,this._nodes[g].child1=_,this._nodes[g].child2=e,this._nodes[_].parentOrNext=g,this._nodes[e].parentOrNext=g):(this._nodes[g].child1=_,this._nodes[g].child2=e,this._nodes[_].parentOrNext=g,this._nodes[e].parentOrNext=g,this._root=g),n=this._nodes[e].parentOrNext;n!=i.nullNode;){n=this.balance(n);s=this._nodes[n].child1,r=this._nodes[n].child2;console.assert(s!=i.nullNode),console.assert(r!=i.nullNode),this._nodes[n].height=1+Math.max(this._nodes[s].height,this._nodes[r].height),this._nodes[n].aabb.combine2(this._nodes[s].aabb,this._nodes[r].aabb),n=this._nodes[n].parentOrNext}},i.prototype.removeLeaf=function(t){if(t!=this._root){var e=this._nodes[t].parentOrNext,o=this._nodes[e].parentOrNext,n=0;if(n=this._nodes[e].child1==t?this._nodes[e].child2:this._nodes[e].child1,o!=i.nullNode){this._nodes[o].child1==e?this._nodes[o].child1=n:this._nodes[o].child2=n,this._nodes[n].parentOrNext=o,this.freeNode(e);for(var s=o;s!=i.nullNode;){s=this.balance(s);var r=this._nodes[s].child1,a=this._nodes[s].child2;this._nodes[s].aabb.combine2(this._nodes[r].aabb,this._nodes[a].aabb),this._nodes[s].height=1+Math.max(this._nodes[r].height,this._nodes[a].height),s=this._nodes[s].parentOrNext}}else this._root=n,this._nodes[n].parentOrNext=i.nullNode,this.freeNode(e)}else this._root=i.nullNode},i.prototype.balance=function(t){console.assert(t!=i.nullNode);var e=this._nodes[t];if(e.isLeaf()||e.height<2)return t;var o=e.child1,n=e.child2;console.assert(0<=o&&o<this._nodeCapacity),console.assert(0<=n&&n<this._nodeCapacity);var s=this._nodes[o],r=this._nodes[n];if(r.height-s.height>1){var a=r.child1,h=r.child2,c=this._nodes[a],u=this._nodes[h];return console.assert(0<=a&&a<this._nodeCapacity),console.assert(0<=h&&h<this._nodeCapacity),r.child1=t,r.parentOrNext=e.parentOrNext,e.parentOrNext=n,r.parentOrNext!=i.nullNode?this._nodes[r.parentOrNext].child1==t?this._nodes[r.parentOrNext].child1=n:(console.assert(this._nodes[r.parentOrNext].child2==t),this._nodes[r.parentOrNext].child2=n):this._root=n,c.height>u.height?(r.child2=a,e.child2=h,u.parentOrNext=t,e.aabb.combine2(s.aabb,u.aabb),r.aabb.combine2(e.aabb,c.aabb),e.height=1+Math.max(s.height,u.height),r.height=1+Math.max(e.height,c.height)):(r.child2=h,e.child2=a,c.parentOrNext=t,e.aabb.combine2(s.aabb,c.aabb),r.aabb.combine2(e.aabb,u.aabb),e.height=1+Math.max(s.height,c.height),r.height=1+Math.max(e.height,u.height)),n}},i.nullNode=-1,i}();t.DynamicTree=i}(physics||(physics={})),function(t){!function(){function t(){this.proxyIdA=0,this.proxyIdB=0}t.prototype.compareTo=function(t){if(this.proxyIdA<t.proxyIdA)return-1;if(this.proxyIdA==t.proxyIdA){if(this.proxyIdB<t.proxyIdB)return-1;if(this.proxyIdB==t.proxyIdB)return 0}return 1}}();var e=function(){function e(){this._moveCapacity=0,this._moveCount=0,this._pairCapacity=0,this._pairCount=0,this._proxyCount=0,this._queryProxyId=0,this._tree=new t.DynamicTree,this._queryCallback=this.queryCallback,this._proxyCount=0,this._pairCapacity=16,this._pairCount=0,this._pairBuffer=[],this._moveCapacity=16,this._moveCount=0,this._moveBuffer=[]}return Object.defineProperty(e.prototype,"proxyCount",{get:function(){return this._proxyCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"treeQuality",{get:function(){return this._tree.areaRatio},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"treeBalance",{get:function(){return this._tree.maxBalance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"treeHeight",{get:function(){return this._tree.height},enumerable:!0,configurable:!0}),e.prototype.addProxy=function(t){var e=this._tree.addProxy(t.aabb,t);return++this._proxyCount,this.bufferMove(e),e},e.prototype.removeProxy=function(t){this.unBufferMove(t),--this._proxyCount,this._tree.removeProxy(t)},e.prototype.touchProxy=function(t){this.bufferMove(t)},e.prototype.bufferMove=function(t){if(this._moveCount==this._moveCapacity){var e=this._moveBuffer;this._moveCapacity*=2,this._moveBuffer=e.slice(0,this._moveCount)}this._moveBuffer[this._moveCount]=t,++this._moveCount},e.prototype.unBufferMove=function(e){for(var i=0;i<this._moveCount;++i)this._moveBuffer[i]==e&&(this._moveBuffer[i]=t.DynamicTree.nullNode)},e.prototype.queryCallback=function(t){if(t==this._queryProxyId)return!0;if(this._pairCount==this._pairCapacity){var e=this._pairBuffer;this._pairCapacity*=2,this._pairBuffer=e.slice(0,this._pairCount)}return this._pairBuffer[this._pairCount].proxyIdA=Math.min(t,this._queryProxyId),this._pairBuffer[this._pairCount].proxyIdB=Math.max(t,this._queryProxyId),++this._pairCount,!0},e.prototype.getProxy=function(t){return this._tree.getUserData(t)},e.prototype.testOverlap=function(e,i){var o=this._tree.getFatAABB(e),n=this._tree.getFatAABB(i);return t.AABB.testOverlap(o,n)},e.nullProxy=-1,e}();t.DynamicTreeBroadPhase=e}(physics||(physics={})),function(t){var e=function(){return function(){this.proxyA=new t.DistanceProxy,this.proxyB=new t.DistanceProxy}}();t.TOIInput=e,function(t){t[t.unknown=0]="unknown",t[t.failed=1]="failed",t[t.overlapped=2]="overlapped",t[t.touching=3]="touching",t[t.seperated=4]="seperated"}(t.TOIOutputState||(t.TOIOutputState={}))}(physics||(physics={})),function(t){var e,i=function(){function t(){}return t.equals=function(t,e){return t.area==e.area&&t.mass==e.mass&&t.centroid==e.centroid&&t.inertia==e.inertia},t.notEquals=function(e,i){return!t.equals(e,i)},t.prototype.equals=function(e){return t.equals(this,e)},t}();t.MassData=i,function(t){t[t.unknown=-1]="unknown",t[t.circle=0]="circle",t[t.edge=1]="edge",t[t.polygon=2]="polygon",t[t.chain=3]="chain",t[t.typeCount=4]="typeCount"}(e=t.ShapeType||(t.ShapeType={}));var o=function(){function t(t){this._density=t,this.shapeType=e.unknown}return Object.defineProperty(t.prototype,"density",{get:function(){return this._density},set:function(t){console.assert(t>=0),this._density=t,this.computeProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(t){console.assert(t>=0),this._radius=t,this._2radius=this._radius*this._radius,this.computeProperties()},enumerable:!0,configurable:!0}),t.prototype.compareTo=function(t){return!1},t}();t.Shape=o}(physics||(physics={})),function(t){var e=function(e){function i(i,o){var n=e.call(this,0)||this;return n.shapeType=t.ShapeType.edge,n._radius=t.Settings.polygonRadius,i&&o&&n.set(i,o),n}return __extends(i,e),Object.defineProperty(i.prototype,"childCount",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"vertex1",{get:function(){return this._vertex1},set:function(t){this._vertex1=t,this.computeProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"vertex2",{get:function(){return this._vertex2},set:function(t){this._vertex2=t,this.computeProperties()},enumerable:!0,configurable:!0}),i.prototype.set=function(t,e){this._vertex1=t,this._vertex2=e,this.hasVertex0=!1,this.hasVertex3=!1,this.computeProperties()},i.prototype.testPoint=function(t,e){return!1},i.prototype.rayCast=function(e,i,o,n){var s=t.MathUtils.mul_rv(o.q,es.Vector2.subtract(i.point1,o.p)),r=t.MathUtils.mul_rv(o.q,es.Vector2.subtract(i.point2,o.p)),a=es.Vector2.subtract(r,s),h=this._vertex1.clone(),c=this._vertex2.clone(),u=es.Vector2.subtract(c,h),l=new es.Vector2(u.y,-u.x);es.Vector2Ext.normalize(l);var p=es.Vector2.dot(l,es.Vector2.subtract(h,s)),d=es.Vector2.dot(l,a);if(0==d)return!1;var f=p/d;if(f<0||i.maxFraction<f)return!1;var y=es.Vector2.add(s,es.Vector2.multiplyScaler(a,f)),_=es.Vector2.subtract(c,h),v=es.Vector2.dot(_,_);if(0==v)return!1;var g=es.Vector2.dot(es.Vector2.subtract(y,h),_)/v;return!(g<0||1<g)&&(e.fraction=f,e.normal=p>0?new es.Vector2(-l.x,-l.y):l.clone(),!0)},i.prototype.computeAABB=function(e,i,o){var n=t.MathUtils.mul_tv(i,this._vertex1),s=t.MathUtils.mul_tv(i,this._vertex2),r=es.Vector2.min(n,s),a=es.Vector2.max(n,s),h=new es.Vector2(this.radius,this.radius);e.lowerBound=es.Vector2.subtract(r,h),e.upperBound=es.Vector2.add(a,h)},i.prototype.computeProperties=function(){this.massData.centroid=es.Vector2.add(this.vertex1,this.vertex2).multiplyScaler(.5)},i.prototype.computeSubmergedArea=function(t,e,i,o){return o.x=0,o.y=0,0},i.prototype.clone=function(){var t=new i;return t.shapeType=this.shapeType,t._radius=this._radius,t._density=this._density,t.hasVertex0=this.hasVertex0,t.hasVertex3=this.hasVertex3,t.vertex0=this.vertex0,t._vertex1=this._vertex1,t._vertex2=this._vertex2,t.vertex2=this.vertex3,t.massData=this.massData,t},i}(t.Shape);t.EdgeShape=e}(physics||(physics={})),function(t){var e=function(e){function i(i,o){void 0===o&&(o=!1);var n=e.call(this,0)||this;return n.shapeType=t.ShapeType.chain,n._radius=t.Settings.polygonRadius,i&&n.setVertices(i,o),n}return __extends(i,e),Object.defineProperty(i.prototype,"childCount",{get:function(){return this.vertices.length-1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"prevVertex",{get:function(){return this._prevVertex},set:function(t){this._prevVertex=t,this._hasPrevVertex=!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nextVertex",{get:function(){return this._nextVertex},set:function(t){this._nextVertex=t,this._hasNextVertex=!0},enumerable:!0,configurable:!0}),i.prototype.getChildEdge=function(e,i){console.assert(0<=i&&i<this.vertices.length-1),console.assert(null!=e),e.shapeType=t.ShapeType.edge,e._radius=this._radius,e.vertex1=this.vertices[i+0],e.vertex2=this.vertices[i+1],i>0?(e.vertex0=this.vertices[i-1],e.hasVertex0=!0):(e.vertex0=this._prevVertex,e.hasVertex0=this._hasPrevVertex),i<this.vertices.length-2?(e.vertex3=this.vertices[i+2],e.hasVertex3=!0):(e.vertex3=this._nextVertex,e.hasVertex3=this._hasNextVertex)},i.prototype.setVertices=function(e,i){void 0===i&&(i=!1),console.assert(null!=e&&e.length>=3),console.assert(e[0]!=e[e.length-1]);for(var o=1;o<e.length;++o){var n=e[o-1],s=e[o];console.assert(es.Vector2.distanceSquared(n,s)>t.Settings.linearSlop*t.Settings.linearSlop)}this.vertices=e,i&&(this.vertices.push(e[0]),this.prevVertex=this.vertices[this.vertices.length-2],this.nextVertex=this.vertices[1])},i.prototype.testPoint=function(t,e){return!1},i.prototype.rayCast=function(t,e,o,n){console.assert(n<this.vertices.length);var s=n,r=n+1;return r==this.vertices.length&&(r=0),i._edgeShape.vertex1=this.vertices[s],i._edgeShape.vertex2=this.vertices[r],i._edgeShape.rayCast(t,e,o,0)},i.prototype.computeAABB=function(e,i,o){console.assert(o<this.vertices.length);var n=o,s=o+1;s==this.vertices.length&&(s=0);var r=t.MathUtils.mul_tv(i,this.vertices[n]),a=t.MathUtils.mul_tv(i,this.vertices[s]);e.lowerBound=es.Vector2.min(r,a),e.upperBound=es.Vector2.max(r,a)},i.prototype.computeProperties=function(){},i.prototype.computeSubmergedArea=function(t,e,i,o){return o.x=0,o.y=0,0},i.prototype.clone=function(){var e=new i;return e.shapeType=this.shapeType,e._density=this._density,e._radius=this._radius,e.prevVertex=this._prevVertex,e.nextVertex=this._nextVertex,e._hasNextVertex=this._hasNextVertex,e._hasPrevVertex=this._hasPrevVertex,e.vertices=new t.Vertices(this.vertices),e.massData=this.massData,e},i._edgeShape=new t.EdgeShape,i}(t.Shape);t.ChainShape=e}(physics||(physics={})),function(t){var e=function(e){function i(i,o){void 0===i&&(i=0),void 0===o&&(o=0);var n=e.call(this,o)||this;return console.assert(i>=0),console.assert(o>=0),n.shapeType=t.ShapeType.circle,n._position=es.Vector2.zero,n.radius=i,n}return __extends(i,e),Object.defineProperty(i.prototype,"childCount",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,this.computeProperties()},enumerable:!0,configurable:!0}),i.prototype.testPoint=function(e,i){var o=es.Vector2.add(e.p,t.MathUtils.mul_rv(e.q,this.position)),n=es.Vector2.subtract(i,o);return es.Vector2.dot(n,n)<=this._2radius},i.prototype.rayCast=function(e,i,o,n){var s=es.Vector2.add(o.p,t.MathUtils.mul_rv(o.q,this.position)),r=es.Vector2.subtract(i.point1,s),a=es.Vector2.dot(r,r)-this._2radius,h=es.Vector2.subtract(i.point2,i.point1),c=es.Vector2.dot(r,h),u=es.Vector2.dot(h,h),l=c*c-u*a;if(l<0||u<t.Settings.epsilon)return!1;var p=-(c+Math.sqrt(l));return 0<=p&&p<=i.maxFraction*u&&(p/=u,e.fraction=p,e.normal=es.Vector2.add(r,es.Vector2.multiplyScaler(h,p)),es.Vector2Ext.normalize(e.normal),!0)},i.prototype.computeAABB=function(e,i,o){var n=es.Vector2.add(i.p,t.MathUtils.mul_rv(i.q,this.position));e.lowerBound=new es.Vector2(n.x-this.radius,n.y-this.radius),e.upperBound=new es.Vector2(n.x+this.radius,n.y+this.radius)},i.prototype.computeProperties=function(){var e=t.Settings.pi*this._2radius;this.massData.area=e,this.massData.mass=this.density*e,this.massData.centroid=this.position.clone(),this.massData.inertia=this.massData.mass*(.5*this._2radius+es.Vector2.dot(this.position,this.position))},i.prototype.computeSubmergedArea=function(e,i,o,n){n.x=0,n.y=0;var s=t.MathUtils.mul_tv(o,this.position),r=-(es.Vector2.dot(e,s)-i);if(r<-this.radius+t.Settings.epsilon)return 0;if(r>this.radius)return n=s,t.Settings.pi*this._2radius;var a=r*r,h=this._2radius*(Math.asin(r/this.radius)+t.Settings.pi/2)+r*Math.sqrt(this._2radius-a),c=-2/3*Math.pow(this._2radius-a,1.5)/h;return n.x=s.x+e.x*c,n.y=s.y+e.y*c,h},i.prototype.compareTo=function(t){return this.radius==t.radius&&this.position.equals(t.position)},i.prototype.clone=function(){var t=new i;return t.shapeType=this.shapeType,t._radius=this.radius,t._2radius=this._2radius,t._density=this._density,t._position=this._position,t.massData=this.massData,t},i}(t.Shape);t.CircleShape=e}(physics||(physics={})),function(t){var e=function(e){function i(i,o){void 0===o&&(o=0);var n=e.call(this,o)||this;return n.shapeType=t.ShapeType.polygon,n._radius=t.Settings.polygonRadius,n._vertices=i||new t.Vertices,n._normals=new t.Vertices,n}return __extends(i,e),Object.defineProperty(i.prototype,"vertices",{get:function(){return this._vertices},set:function(e){this.setVerticesNoCopy(new t.Vertices(e))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"normals",{get:function(){return this._normals},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"childCount",{get:function(){return 1},enumerable:!0,configurable:!0}),i.prototype.setVerticesNoCopy=function(e){console.assert(e.length>=3&&e.length<=t.Settings.maxPolygonVertices),this._vertices=e,t.Settings.useConvexHullPolygons&&(this._vertices.length<=3?this._vertices.forceCounterClockWise():this._vertices=t.GiftWrap.getConvexHull(this._vertices)),null==this._normals?this._normals=new t.Vertices:this._normals.length=0;for(var i=0;i<this._vertices.length;++i){var o=i+1<this._vertices.length?i+1:0,n=this._vertices[o].sub(this._vertices[i]);console.assert(n.lengthSquared()>t.Settings.epsilon*t.Settings.epsilon);var s=new es.Vector2(n.y,-n.x);es.Vector2Ext.normalize(s),this._normals.push(s)}this.computeProperties()},i.prototype.computeProperties=function(){if(console.assert(this.vertices.length>=3),!(this._density<=0)){for(var e=es.Vector2.zero,i=0,o=0,n=es.Vector2.zero,s=0;s<this.vertices.length;++s)n.add(this.vertices[s]);n.multiplyScaler(1/this.vertices.length);for(s=0;s<this.vertices.length;++s){var r=this.vertices[s].sub(n),a=s+1<this.vertices.length?this.vertices[s+1].sub(n):this.vertices[0].sub(n),h=t.MathUtils.cross(r,a),c=.5*h;i+=c,e.add(es.Vector2.add(r,a).multiplyScaler(c*(1/3)));var u=r.x,l=r.y,p=a.x,d=a.y;o+=1/3*.25*h*(u*u+p*u+p*p+(l*l+d*l+d*d))}console.assert(i>t.Settings.epsilon),this.massData.area=i,this.massData.mass=this._density*i,e.multiplyScaler(1/i),this.massData.centroid=es.Vector2.add(e,n),this.massData.inertia=this._density*o,this.massData.inertia+=this.massData.mass*(this.massData.centroid.dot(this.massData.centroid)-e.dot(e))}},i.prototype.testPoint=function(e,i){for(var o=t.MathUtils.mul(e.q,i.sub(e.p)),n=0;n<this.vertices.length;++n){if(this.normals[n].dot(o.sub(this.vertices[n]))>0)return!1}return!0},i.prototype.rayCast=function(e,i,o,n){for(var s=t.MathUtils.mul(o.q,i.point1.sub(o.p)),r=t.MathUtils.mul(o.q,i.point2.sub(o.p)).sub(s),a=0,h=i.maxFraction,c=-1,u=0;u<this.vertices.length;++u){var l=this.normals[u].dot(this.vertices[u].sub(s)),p=this.normals[u].dot(r);if(0==p){if(l<0)return!1}else p<0&&l<a*p?(a=l/p,c=u):p>0&&l<h*p&&(h=l/p);if(h<a)return!1}return console.assert(0<=a&&a<=i.maxFraction),c>=0&&(e.fraction=a,e.normal=t.MathUtils.mul(o.q,this.normals[c]),!0)},i.prototype.computeAABB=function(e,i,o){for(var n=t.MathUtils.mul(i,this.vertices[0]),s=n.clone(),r=1;r<this.vertices.length;++r){var a=t.MathUtils.mul(i,this.vertices[r]);n=es.Vector2.min(n,a),s=es.Vector2.max(s,a)}var h=new es.Vector2(this.radius,this.radius);e.lowerBound=n.sub(h),e.upperBound=es.Vector2.add(s,h)},i.prototype.computeSubmergedArea=function(e,i,o,n){n.x=0,n.y=0;var s,r=t.MathUtils.mul(o.q,e),a=i-e.dot(o.p),h=[],c=0,u=-1,l=-1,p=!1;for(s=0;s<this.vertices.length;s++){h[s]=r.dot(this.vertices[s])-a;var d=h[s]<-t.Settings.epsilon;s>0&&(d?p||(u=s-1,c++):p&&(l=s-1,c++)),p=d}switch(c){case 0:return p?(n=t.MathUtils.mul(o,this.massData.centroid),this.massData.mass/this.density):0;case 1:-1==u?u=this.vertices.length-1:l=this.vertices.length-1}var f=(u+1)%this.vertices.length,y=(l+1)%this.vertices.length,_=(0-h[u])/(h[f]-h[u]),v=(0-h[l])/(h[y]-h[l]),g=new es.Vector2(this.vertices[u].x*(1-_)+this.vertices[f].x*_,this.vertices[u].y*(1-_)+this.vertices[f].y*_),b=new es.Vector2(this.vertices[l].x*(1-v)+this.vertices[y].x*v,this.vertices[l].y*(1-v)+this.vertices[y].y*v),x=0,m=new es.Vector2(0,0),w=this.vertices[f];for(s=f;s!=y;){var C=void 0;C=(s=(s+1)%this.vertices.length)==y?b:this.vertices[s];var B=w.sub(g),A=C.sub(g),V=.5*t.MathUtils.cross(B,A);x+=V,m.add(es.Vector2.add(g,w).add(C).multiplyScaler(V*(1/3))),w=C.clone()}return m.multiplyScaler(1/x),n=t.MathUtils.mul(o,m),x},i.prototype.clone=function(){var e=new i;return e.shapeType=this.shapeType,e._radius=this._radius,e._density=this._density,e._vertices=new t.Vertices(this._vertices),e._normals=new t.Vertices(this._normals),e.massData=this.massData,e},i}(t.Shape);t.PolygonShape=e}(physics||(physics={})),function(t){var e=function(){function t(){}return t.simToDisplay=100,t.displayToSim=1/t.simToDisplay,t}();t.FSConvert=e}(physics||(physics={})),function(t){var e=function(){function t(){}return t.prototype.get=function(t){switch(t){case 0:return this._value0;case 1:return this._value1;default:throw new Error("index out of range")}},t.prototype.set=function(t,e){switch(t){case 0:this._value0=e;break;case 1:this._value1=e;break;default:throw new Error("index out of range")}},t}();t.FixedArray2=e;var i=function(){function t(){}return t.prototype.get=function(t){switch(t){case 0:return this._value0;case 1:return this._value1;case 2:return this._value2;default:throw new Error("index out of range")}},t.prototype.set=function(t,e){switch(t){case 0:this._value0=e;break;case 1:this._value1=e;break;case 2:this._value2=e;break;default:throw new Error("index out of range")}},t}();t.FixedArray3=i}(physics||(physics={})),function(t){var e=function(){function t(){}return t.prototype.getTransform=function(t,e){t.p.x=(1-e)*this.c0.x+e*this.c.x,t.p.y=(1-e)*this.c0.y+e*this.c.y;var i=(1-e)*this.a0+e*this.a;t.q.set(i),t.p.sub(n.mul(t.q,this.localCenter))},t.prototype.advance=function(t){console.assert(this.alpha0<1);var e=(t-this.alpha0)/(1-this.alpha0);this.c0.add(this.c.sub(this.c0).multiplyScaler(e)),this.a0+=e*(this.a-this.a0),this.alpha0=t},t.prototype.normalize=function(){var t=2*Math.PI*Math.floor(this.a0/(2*Math.PI));this.a0-=t,this.a-=t},t}();t.Sweep=e;var i=function(){function t(t,e){this.p=t,this.q=e}return t.prototype.setIdentity=function(){this.p=es.Vector2.zero,this.q.setIdentity()},t.prototype.set=function(t,e){this.p=t,this.q.set(e)},t}();t.Transform=i;var o=function(){function t(t){this.s=Math.sin(t),this.c=Math.cos(t)}return t.prototype.set=function(t){0==t?(this.s=0,this.c=1):(this.s=Math.sin(t),this.c=Math.cos(t))},t.prototype.setIdentity=function(){this.s=0,this.c=1},t.prototype.getAngle=function(){return Math.atan2(this.s,this.c)},t.prototype.getXAxis=function(){return new es.Vector2(this.c,this.s)},t.prototype.getYAxis=function(){return new es.Vector2(-this.s,this.c)},t}();t.Rot=o;var n=function(){function t(){}return t.mul=function(t,e){if(t instanceof i&&e instanceof es.Vector2){var n=t.q.c*e.x-t.q.s*e.y+t.p.x,r=t.q.s*e.x+t.q.c*e.y+t.p.y;return new es.Vector2(n,r)}if(t instanceof o&&e instanceof es.Vector2)return new es.Vector2(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y);if(t instanceof s&&e instanceof es.Vector2)return new es.Vector2(e.x*t.ex.x+e.y*t.ex.y,e.x*t.ey.x+e.y*t.ey.y);if(t instanceof o&&e instanceof o){var a=new o(0);return a.s=t.c*e.s-t.s*e.c,a.c=t.c*e.c+t.s*e.s,a}return t instanceof o&&e instanceof es.Vector2?new es.Vector2(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y):void 0},t.cross=function(t,e){return t.x*e.y-t.y*e.x},t}();t.MathUtils=n;var s=function(){return function(t,e){this.ex=t,this.ey=e}}();t.Mat22=s}(physics||(physics={})),function(t){!function(t){t[t.noError=0]="noError",t[t.invalidAmountOfVertices=1]="invalidAmountOfVertices",t[t.notSimple=2]="notSimple",t[t.notCounterClockWise=3]="notCounterClockWise",t[t.notConvex=4]="notConvex",t[t.areaTooSmall=5]="areaTooSmall",t[t.sideTooSmall=6]="sideTooSmall"}(t.PolygonError||(t.PolygonError={}));var e=function(e){function i(t){var i,o;void 0===t&&(t=null);var n=e.call(this)||this;if(t)try{for(var s=__values(t),r=s.next();!r.done;r=s.next()){var a=r.value;n.push(a)}}catch(t){i={error:t}}finally{try{r&&!r.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}return n}return __extends(i,e),i.prototype.nextIndex=function(t){return t+1>this.length-1?0:t+1},i.prototype.nextVertex=function(t){return this[this.nextIndex(t)]},i.prototype.previousIndex=function(t){return t-1<0?this.length-1:t-1},i.prototype.previousVertx=function(t){return this[this.previousIndex(t)]},i.prototype.getSignedArea=function(){if(this.length<3)return 0;var t,e=0;for(t=0;t<this.length;t++){var i=(t+1)%this.length,o=this[t],n=this[i];e+=o.x*n.y,e-=o.y*n.x}return e/=2},i.prototype.getArea=function(){var t=this.getSignedArea();return t<0?-t:t},i.prototype.getCentroid=function(){if(this.length<3)return new es.Vector2(Number.NaN,Number.NaN);for(var t=es.Vector2.zero,e=0,i=0;i<this.length;++i){var o=this[i],n=i+1<this.length?this[i+1]:this[0],s=.5*(o.x*n.y-o.y*n.x);e+=s,t.add(o.add(n).scale(s*(1/3)))}return t.multiplyScaler(1/e),t},i.prototype.getAABB=function(){for(var e=new es.Vector2(Number.MAX_VALUE,Number.MAX_VALUE),i=new es.Vector2(Number.MIN_VALUE,Number.MIN_VALUE),o=0;o<this.length;++o)this[o].x<e.x&&(e.x=this[o].x),this[o].x>i.x&&(i.x=this[o].x),this[o].y<e.y&&(e.y=this[o].y),this[o].y>i.y&&(i.y=this[o].y);return new t.AABB(e,i)},i.prototype.translate=function(t){var e,i;console.assert(!this.attackedToBody,"平移实体所使用的顶点可能会导致行为不稳定。 使用Body.Position代替 ");for(var o=0;o<this.length;o++)this[o]=es.Vector2.add(this[o],t);if(null!=this.holes&&this.holes.length>0)try{for(var n=__values(this.holes),s=n.next();!s.done;s=n.next()){s.value.translate(t)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}},i.prototype.scale=function(t){var e,i;console.assert(!this.attackedToBody,"Body使用的缩放顶点会导致行为不稳定 ");for(var o=0;o<this.length;o++)this[o]=this[o].multiply(t);if(null!=this.holes&&this.holes.length>0)try{for(var n=__values(this.holes),s=n.next();!s.done;s=n.next()){s.value.scale(t)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}},i.prototype.rotate=function(t){var e,i;console.assert(!this.attackedToBody,"Body使用的旋转顶点可能会导致行为不稳定 ");for(var o=Math.cos(t),n=Math.sin(t),s=0;s<this.length;s++){var r=this[s];this[s]=new es.Vector2(r.x*o+r.y*-n,r.x*n+r.y*o)}if(null!=this.holes&&this.holes.length>0)try{for(var a=__values(this.holes),h=a.next();!h.done;h=a.next()){h.value.rotate(t)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}},i.prototype.isConvex=function(){if(this.length<3)return!1;if(3==this.length)return!0;for(var t=0;t<this.length;++t)for(var e=t+1<this.length?t+1:0,i=this[e].sub(this[t]),o=0;o<this.length;++o)if(o!=t&&o!=e){var n=this[o].sub(this[t]);if(i.x*n.y-i.y*n.x<=0)return!1}return!0},i.prototype.isCounterClockWise=function(){return!(this.length<3)&&this.getSignedArea()>0},i.prototype.forceCounterClockWise=function(){this.length<3||this.isCounterClockWise()||this.reverse()},i}(Array);t.Vertices=e}(physics||(physics={})),function(t){var e=function(){function e(){}return e.getConvexHull=function(e){if(e.length<=3)return e;for(var i=0,o=e[0].x,n=1;n<e.length;++n){var s=e[n].x;(s>o||s==o&&e[n].y<e[i].y)&&(i=n,o=s)}for(var r=[],a=0,h=i;;){r[a]=h;for(var c=0,u=1;u<e.length;++u)if(c!=h){var l=e[c].sub(e[r[a]]),p=e[u].sub(e[r[a]]),d=t.MathUtils.cross(l,p);d<0&&(c=u),0==d&&p.lengthSquared()>l.lengthSquared()&&(c=u)}else c=u;if(++a,h=c,c==i)break}var f=new t.Vertices;for(n=0;n<a;++n)f.push(e[r[n]]);return f},e}();t.GiftWrap=e}(physics||(physics={})),function(t){var e=function(){function e(){this.disabledOnCategories=t.Category.none,this.enabledOnCategories=t.Category.all}return e.prototype.isActiveOn=function(e){var i,o;if(null==e||!e.enabled||e.isStatic)return!1;if(null==e.fixtureList)return!1;try{for(var n=__values(e.fixtureList),s=n.next();!s.done;s=n.next()){var r=s.value;if(r.collisionGroup==this.disabledOnGroup&&0!=r.collisionGroup&&0!=this.disabledOnGroup)return!1;if((r.collisionCategories&this.disabledOnCategories)!=t.Category.none)return!1;if(0==this.enabledOnGroup&&this.enabledOnCategories==t.Category.all)return!0;if(r.collisionGroup==this.enabledOnGroup&&0!=r.collisionGroup&&0!=this.enabledOnGroup)return!0;if((r.collisionCategories&this.enabledOnGroup)!=t.Category.none&&this.enabledOnCategories!=t.Category.all)return!0}}catch(t){i={error:t}}finally{try{s&&!s.done&&(o=n.return)&&o.call(n)}finally{if(i)throw i.error}}return!1},e}();t.FilterData=e}(physics||(physics={})),function(t){!function(t){t[t.Explosion=1]="Explosion"}(t.PhysicsLogicType||(t.PhysicsLogicType={}));var e=function(){function t(){}return t.prototype.ignorePhysicsLogic=function(t){this.controllerIgnores|=t},t}();t.PhysicsLogicFilter=e}(physics||(physics={})),function(t){!function(t){t[t.gravityController=1]="gravityController",t[t.velocityLimitController=2]="velocityLimitController",t[t.abstractForceController=4]="abstractForceController",t[t.buoyancyController=8]="buoyancyController"}(t.ControllerType||(t.ControllerType={}));var e=function(){function t(){}return t.prototype.ignoreController=function(t){this.controllerFlags|=t},t.prototype.restoreController=function(t){this.controllerFlags&=~t},t.prototype.isControllerIgnored=function(t){return(this.controllerFlags&t)==t},t}();t.ControllerFilter=e;var i=function(t){function e(e){var i=t.call(this)||this;return i._type=e,i}return __extends(e,t),e.prototype.isActiveOn=function(e){return!e.controllerFilter.isControllerIgnored(this._type)&&t.prototype.isActiveOn.call(this,e)},e}(t.FilterData);t.Controller=i}(physics||(physics={})),function(t){var e;!function(t){t[t.static=0]="static",t[t.kinematic=1]="kinematic",t[t.dynamic=2]="dynamic"}(e=t.BodyType||(t.BodyType={}));var i=function(){function i(t,o,n,s,r){void 0===o&&(o=new es.Vector2),void 0===n&&(n=0),void 0===s&&(s=e.static),void 0===r&&(r=null),this.fixtureList=[],this.bodyId=i._bodyIdCounter++,this._world=t,this._enabled=!0,this._awake=!0,this._sleepingAllowed=!0,this.userData=r,this.gravityScale=1,this.bodyType=s,this._xf.q.set(n),o.equals(es.Vector2.zero)||(this._xf.p=o,this._sweep.c0=this._xf.p,this._sweep.c=this._xf.p),0!=n&&(this._sweep.a0=n,this._sweep.a=n),this.world.addBody(this)}return Object.defineProperty(i.prototype,"world",{get:function(){return this._world},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"revolutions",{get:function(){return this.rotation/Math.PI},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bodyType",{get:function(){return this._bodyType},set:function(t){this._bodyType!=t&&(this._bodyType=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"linearVelocity",{get:function(){return this._linearVelocity},set:function(t){console.assert(!Number.isNaN(t.x)&&!Number.isNaN(t.y)),this._bodyType!=e.static&&(t.dot(t)>0&&(this.isAwake=!0),this._linearVelocity=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"angularVelocity",{get:function(){return this._angularVelocity},set:function(t){console.assert(!Number.isNaN(t)),this._bodyType!=e.static&&(t*t>0&&(this.isAwake=!0),this._angularVelocity=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"linearDamping",{get:function(){return this._linearDamping},set:function(t){console.assert(!Number.isNaN(t)),this._linearDamping=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"angularDamping",{get:function(){return this._angularDamping},set:function(t){console.assert(!Number.isNaN(t)),this._angularDamping=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSleepingAllowed",{get:function(){return this._sleepingAllowed},set:function(t){t||(this.isAwake=!0),this._sleepingAllowed=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isAwake",{get:function(){return this._awake},set:function(t){t&&(this._awake||(this._sleepTime=0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"enabled",{set:function(t){if(t!=this._enabled){if(t)for(var e=this._world.contactManager.broadPhase,i=0;i<this.fixtureList.length;i++)this.fixtureList[i].createProxies(e,this._xf);else{for(e=this._world.contactManager.broadPhase,i=0;i<this.fixtureList.length;i++)this.fixtureList[i].destroyProxies(e);for(var o=this.contactList;null!=o;){var n=o;o=o.next,this._world.contactManager.destroy(n.contact)}this.contactList=null}this._enabled=t}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fixedRotation",{get:function(){return this._fixedRotation},set:function(t){this._fixedRotation!=t&&(this._fixedRotation=t,this._angularVelocity=0,this.resetMassData())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this._xf.p},set:function(t){console.assert(!Number.isNaN(t.x)&&!Number.isNaN(t.y))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayPosition",{get:function(){return this._xf.p.scale(t.FSConvert.simToDisplay)},set:function(e){this.position=e.scale(t.FSConvert.displayToSim)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rotation",{get:function(){return this._sweep.a},set:function(t){console.assert(!Number.isNaN(t))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isStatic",{get:function(){return this._bodyType==e.static},set:function(t){this.bodyType=t?e.static:e.dynamic},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isKinematic",{get:function(){return this._bodyType==e.kinematic},set:function(t){this.bodyType=t?e.kinematic:e.dynamic},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isDynamic",{get:function(){return this._bodyType==e.dynamic},set:function(t){this.bodyType=t?e.dynamic:e.kinematic},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"worldCenter",{get:function(){return this._sweep.c},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"localCenter",{get:function(){return this._sweep.localCenter},set:function(i){if(this._bodyType==e.dynamic){var o=this._sweep.c.clone();this._sweep.localCenter=i,this._sweep.c0=this._sweep.c=t.MathUtils.mul(this._xf,this._sweep.localCenter);var n=this._sweep.c.sub(o);this._linearVelocity.add(new es.Vector2(-this._angularVelocity*n.y,this._angularVelocity*n.x))}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mass",{get:function(){return this._mass},set:function(t){console.assert(!Number.isNaN(t)),this._bodyType==e.dynamic&&(this._mass=t,this._mass<=0&&(this._mass=1),this._invMass=1/this._mass)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"inertia",{get:function(){return this._inertia+this.mass*this._sweep.localCenter.dot(this._sweep.localCenter)},set:function(t){console.assert(!Number.isNaN(t)),this._bodyType==e.dynamic&&t>0&&!this._fixedRotation&&(this._inertia=t-this.mass*this.localCenter.dot(this.localCenter),console.assert(this._inertia>0),this._invI=1/this._inertia)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"restitution",{get:function(){for(var t=0,e=0;e<this.fixtureList.length;e++){t+=this.fixtureList[e].restitution}return this.fixtureList.length>0?t/this.fixtureList.length:0},set:function(t){for(var e=0;e<this.fixtureList.length;e++){this.fixtureList[e].restitution=t}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"friction",{get:function(){for(var t=0,e=0;e<this.fixtureList.length;e++){t+=this.fixtureList[e].friction}return this.fixtureList.length>0?t/this.fixtureList.length:0},set:function(t){for(var e=0;e<this.fixtureList.length;e++){this.fixtureList[e].friction=t}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"collisionCategories",{set:function(t){for(var e=0;e<this.fixtureList.length;e++){this.fixtureList[e].collisionCategories=t}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"collidesWith",{set:function(t){for(var e=0;e<this.fixtureList.length;e++){this.fixtureList[e].collidesWith=t}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ignoreCCDWith",{set:function(t){for(var e=0;e<this.fixtureList.length;e++){this.fixtureList[e].ignoreCCDWith=t}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"collisionGroup",{set:function(t){for(var e=0;e<this.fixtureList.length;e++){this.fixtureList[e].collisionGroup=t}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSensor",{set:function(t){for(var e=0;e<this.fixtureList.length;e++){this.fixtureList[e].isSensor=t}},enumerable:!0,configurable:!0}),i.prototype.addOnCollision=function(t){for(var e=0;e<this.fixtureList.length;e++)this.fixtureList[e].onCollision.push(t)},i.prototype.removeOnCollision=function(t){for(var e=0;e<this.fixtureList.length;e++)new es.List(this.fixtureList[e].onCollision).remove(t)},i.prototype.addOnSeparation=function(t){for(var e=0;e<this.fixtureList.length;e++)this.fixtureList[e].onSeperation.push(t)},i.prototype.removeOnSeparation=function(t){for(var e=0;e<this.fixtureList.length;e++)new es.List(this.fixtureList[e].onSeperation).remove(t)},i.prototype.resetDynamics=function(){this._torque=0,this._angularVelocity=0,this._force=es.Vector2.zero,this._linearVelocity=es.Vector2.zero},i.prototype.createFixture=function(e,i){return void 0===i&&(i=null),new t.Fixture(this,e,i)},i.prototype.destroyFixture=function(t){console.assert(t.body==this),console.assert(this.fixtureList.length>0),console.assert(new es.List(this.fixtureList).contains(t));for(var e=this.contactList;null!=e;){var i=e.contact;e=e.next;var o=i.fixtureA,n=i.fixtureB;t!=o&&t!=n||this._world.contactManager.destroy(i)}if(this._enabled){var s=this._world.contactManager.broadPhase;t.destroyProxies(s)}new es.List(this.fixtureList).remove(t),t.destroy(),t.body=null,this.resetMassData()},i.prototype.resetMassData=function(){if(this._mass=0,this._invMass=0,this._inertia=0,this._invI=0,this._sweep.localCenter=es.Vector2.zero,this.bodyType==e.kinematic)return this._sweep.c0=this._xf.p,this._sweep.c=this._xf.p,void(this._sweep.a0=this._sweep.a);console.assert(this.bodyType==e.dynamic||this.bodyType==e.static);for(var i=es.Vector2.zero,o=0;o<this.fixtureList.length;o++){var n=this.fixtureList[o];if(0!=n.shape._density){var s=n.shape.massData;this._mass+=s.mass,this.localCenter=this.localCenter.add(s.centroid.scale(s.mass)),this._inertia+=s.inertia}}if(this.bodyType!=e.static){this._mass>0?(this._invMass=1/this._mass,i=i.scale(this._invMass)):(this._mass=1,this._invMass=1),this._invMass>0&&!this._fixedRotation?(this._inertia-=this._mass*i.dot(i),console.assert(this._inertia>0),this._invI=1/this._inertia):(this._inertia=0,this._invI=0);var r=this._sweep.c;this._sweep.localCenter=i,this._sweep.c0=this._sweep.c=t.MathUtils.mul(this._xf,this._sweep.localCenter);var a=this._sweep.c.sub(r);this._linearVelocity=this._linearVelocity.add(new es.Vector2(-this._angularVelocity*a.y,this._angularVelocity*a.x))}else this._sweep.c0=this._sweep.c=this._xf.p},i.prototype.shouldCollide=function(t){if(this._bodyType!=e.dynamic&&t._bodyType!=e.dynamic)return!1;for(var i=this.jointList;null!=i;i=i.next)if(i.other==t&&0==i.joint.collideConnected)return!1;return!0},i}();t.Body=i}(physics||(physics={})),function(t){var e=function(){function t(t,e,i,o,n){void 0===o&&(o=new es.Vector2),void 0===n&&(n=0),this.parts=[],this.strength=500,this._angularVelocitiesCache=[],this._velocitiesCache=[],this._world=t,this._world.contactManager.onPostSolve.push(this.onPostSolve)}return t.prototype.onPostSolve=function(t,e){if(!this.isBroken){var i=new es.List(this.parts);if(i.contains(t.fixtureA)||i.contains(t.fixtureB)){for(var o=0,n=t.manifold.pointCount,s=0;s<n;++s)o=Math.max(o,e.points[s].normalImpulse);o>this.strength&&(this._break=!0)}}},t.prototype.update=function(){if(this._break&&(this.decompose(),this.isBroken=!0,this._break=!1),0==this.isBroken){this.parts.length>this._angularVelocitiesCache.length&&(this._velocitiesCache=[],this._angularVelocitiesCache=[]);for(var t=0;t<this.parts.length;t++)this._velocitiesCache[t]=this.parts[t].body.linearVelocity,this._angularVelocitiesCache[t]=this.parts[t].body.angularVelocity}},t.prototype.decompose=function(){new es.List(this._world.contactManager.onPostSolve).remove(this.onPostSolve);for(var t=0;t<this.parts.length;t++){var e=this.parts[t];e.shape.clone(),e.userData;this.mainBody.destroyFixture(e)}},t}();t.BreakableBody=e}(physics||(physics={})),function(t){var e=function(){function e(t){this.contactList=[],this.activeContacts=new Set,this.activeList=[],this.broadPhase=t,this.onBroadphaseCollision.push(this.addPair)}return e.prototype.addPair=function(t,e){var i=t.fixture,o=e.fixture,n=t.childIndex,s=e.childIndex,r=i.body,a=o.body;if(r!=a)for(var h=a.contactList;null!=h;){if(h.other==r){var c=h.contact.fixtureA,u=h.contact.fixtureB,l=h.contact.childIndexA,p=h.contact.childIndexB;if(c==i&&u==o&&l==n&&p==s)return;if(c==o&&u==i&&l==s&&p==n)return}h=h.next}},e.prototype.findNewContacts=function(){},e.prototype.destroy=function(t){var e=t.fixtureA,i=t.fixtureB,o=e.body,n=i.body;t.isTouching&&(null!=e&&null!=e.onSeperation&&e.onSeperation.forEach(function(t){return t(e,i)}),null!=i&&null!=i.onSeperation&&i.onSeperation.forEach(function(t){return t(i,e)}),null!=this.onEndContact&&this.onEndContact.forEach(function(e){return e(t)})),new es.List(this.contactList).remove(t),null!=t._nodeA.prev&&(t._nodeA.prev.next=t._nodeA.next),null!=t._nodeA.next&&(t._nodeA.next.prev=t._nodeA.prev),t._nodeA==o.contactList&&(o.contactList=t._nodeA.next),null!=t._nodeB.prev&&(t._nodeB.prev.next=t._nodeB.next),null!=t._nodeB.next&&(t._nodeB.next.prev=t._nodeB.prev),t._nodeB==n.contactList&&(n.contactList=t._nodeB.next),this.activeContacts.has(t)&&this.activeContacts.delete(t),t.destroy()},e.prototype.collide=function(){var i=[];t.Defined.USE_ACTIVE_CONTACT_SET?(this.activeList.concat(Array.from(this.activeContacts)),i=this.activeList):i=this.contactList;for(var o=0;o<i.length;o++){var n=i[o],s=n.fixtureA,r=n.fixtureB,a=n.childIndexA,h=n.childIndexB,c=s.body,u=r.body;if(c.enabled&&u.enabled){if(n.filterFlag){if(0==u.shouldCollide(c)){var l=n;this.destroy(l);continue}if(0==e.shouldCollide(s,r)){l=n;this.destroy(l);continue}if(null!=this.onContactFilter&&0==this.onContactFilter(s,r)){l=n;this.destroy(l);continue}n.filterFlag=!1}var p=c.isAwake&&c.bodyType!=t.BodyType.static,d=u.isAwake&&u.bodyType!=t.BodyType.static;if(0!=p||0!=d){var f=s.proxies[a].proxyId,y=r.proxies[h].proxyId;if(0!=this.broadPhase.testOverlap(f,y))n.update(this);else{l=n;this.destroy(l)}}else t.Defined.USE_ACTIVE_CONTACT_SET&&this.activeContacts.delete(n)}}},e.shouldCollide=function(e,i){if(t.Settings.useFPECollisionCategories)return(e.collisionGroup!=i.collisionGroup||0==e.collisionGroup||0==i.collisionGroup)&&(!(Number((e.collisionCategories&i.collidesWith)==t.Category.none)&Number((i.collisionCategories&e.collidesWith)==t.Category.none))&&(!e.isFixtureIgnored(i)&&!i.isFixtureIgnored(e)));if(e.collisionGroup==i.collisionGroup&&0!=e.collisionGroup)return e.collisionGroup>0;var o=0!=(e.collidesWith&i.collisionCategories)&&0!=(e.collisionCategories&i.collidesWith);return(!o||!e.isFixtureIgnored(i)&&!i.isFixtureIgnored(e))&&o},e}();t.ContactManager=e}(physics||(physics={})),function(t){var e=function(){return function(){}}();t.Island=e}(physics||(physics={})),function(t){var e=function(){return function(){}}();t.TimeStep=e;var i=function(){return function(){}}();t.Position=i;var o=function(){return function(){}}();t.Velocity=o;var n=function(){return function(){}}();t.SolverData=n}(physics||(physics={})),function(t){var e=function(){function e(e){this._tempOverlapCircle=new t.CircleShape,this._stack=[],this._bodyAddList=new Set,this._bodyRemoveList=new Set,this._jointAddList=new Set,this._jointRemoveList=new Set,this._input=new t.TOIInput,this._watch=new es.Stopwatch,this._contactPool=[],this.island=new t.Island,this.enabled=!0,this.controllerList=[],this.breakableBodyList=[],this.bodyList=[],this.jointList=[],this.awakeBodySet=new Set,this.awakeBodyList=[],this.islandSet=new Set,this.TOISet=new Set,this._queryAABBCallbackWrpper=this.queryAABBCallbackWrapper,this._rayCastCallbackWrapper=this.raycastCallbackWrapper,this.gravity=e}return Object.defineProperty(e.prototype,"proxyCount",{get:function(){return this.contactManager.broadPhase.proxyCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contactList",{get:function(){return this.contactManager.contactList},enumerable:!0,configurable:!0}),e.prototype.processChanges=function(){},e.prototype.addBody=function(t){console.assert(!this._bodyAddList.has(t),"You are adding the same body more than once."),this._bodyAddList.has(t)||this._bodyAddList.add(t)},e.prototype.removeBody=function(t){console.assert(!this._bodyRemoveList.has(t),"The body is already marked for removal. You are removing the body more than once."),this._bodyRemoveList.has(t)||this._bodyRemoveList.add(t),this.awakeBodySet.has(t)&&this.awakeBodySet.delete(t)},e.prototype.queryAABBCallbackWrapper=function(t){var e=this.contactManager.broadPhase.getProxy(t);return this._queryAABBCallback(e.fixture)},e.prototype.raycastCallbackWrapper=function(t,e){var i=this.contactManager.broadPhase.getProxy(e),o=i.fixture,n=i.childIndex;if(o.rayCast(void 0,t,n)){var s=(void 0).fraction,r=t.point1.scale(1-s).add(t.point2.scale(s));return this._rayCastCallback(o,r,(void 0).normal,s)}return t.maxFraction},e.prototype.step=function(e){if(this.enabled){t.Settings.enableDiagnostics&&this._watch.start(),this.processChanges(),t.Settings.enableDiagnostics&&(this.addRemoveTime=this._watch.getTime()),this._worldHasNewFixture&&(this.contactManager.findNewContacts(),this._worldHasNewFixture=!1),t.Settings.enableDiagnostics&&(this.newContactsTime=this._watch.getTime()-this.addRemoveTime);var i=new t.TimeStep;i.inv_dt=e>0?1/e:0,i.dt=e,i.dtRatio=this._invDt0*e;for(var o=0;o<this.controllerList.length;o++)this.controllerList[o].update(e);t.Settings.enableDiagnostics&&(this.controllersUpdateTime=this._watch.getTime()-(this.addRemoveTime+this.newContactsTime)),this.contactManager.collide(),t.Settings.enableDiagnostics&&(this.ContactsUpdateTime=this._watch.getTime()-(this.addRemoveTime+this.newContactsTime+this.controllersUpdateTime))}},e.prototype.clear=function(){this.processChanges()},e}();t.World=e}(physics||(physics={})),function(t){var e;!function(t){t[t.notSupported=0]="notSupported",t[t.polygon=1]="polygon",t[t.polygonAndCircle=2]="polygonAndCircle",t[t.circle=3]="circle",t[t.edgeAndPolygon=4]="edgeAndPolygon",t[t.edgeAndCircle=5]="edgeAndCircle",t[t.chainAndPolygon=6]="chainAndPolygon",t[t.chainAndCircle=7]="chainAndCircle"}(e=t.ContactType||(t.ContactType={}));var i=function(){function i(t,e,i,n){this._nodeA=new o,this._nodeB=new o}return i.prototype.resetRestitution=function(){this.restitution=t.Settings.mixRestitution(this.fixtureA.restitution,this.fixtureB.restitution)},i.prototype.resetFriction=function(){this.friction=t.Settings.mixFriction(this.fixtureA.friction,this.fixtureB.friction)},i.prototype.getWorldManifold=function(t,e){this.fixtureA.body,this.fixtureA.body,this.fixtureA.shape,this.fixtureB.shape},i.prototype.reset=function(e,i,o,n){this.enabled=!0,this.isTouching=!1,this.islandFlag=!1,this.filterFlag=!1,this.toiFlag=!1,this.fixtureA=e,this.fixtureB=o,this.childIndexA=i,this.childIndexB=n,this.manifold.pointCount=0,this._nodeA.contact=null,this._nodeA.prev=null,this._nodeA.next=null,this._nodeA.other=null,this._nodeB.contact=null,this._nodeB.prev=null,this._nodeB.next=null,this._nodeB.other=null,this._toiCount=0,null!=this.fixtureA&&null!=this.fixtureB&&(this.friction=t.Settings.mixFriction(this.fixtureA.friction,this.fixtureB.friction),this.restitution=t.Settings.mixRestitution(this.fixtureA.restitution,this.fixtureB.restitution)),this.tangentSpeed=0},i.prototype.update=function(e){var i=this.fixtureA.body,o=this.fixtureB.body;if(null!=this.fixtureA&&null!=this.fixtureB){this.manifold;this.enabled=!0;this.isTouching;if(this.fixtureA.isSensor||this.fixtureB.isSensor){var n=this.fixtureA.shape,s=this.fixtureB.shape;t.Collision.testOverlap(n,this.childIndexA,s,this.childIndexB,i._xf,o._xf),this.manifold.pointCount=0}}},i.prototype.destroy=function(){this.fixtureA.body._world._contactPool.unshift(this),this.manifold.pointCount>0&&0==this.fixtureA.isSensor&&0==this.fixtureB.isSensor&&(this.fixtureA.body.isAwake=!0,this.fixtureB.body.isAwake=!0)},i._edge=new t.EdgeShape,i._contactRegisters=[[e.circle,e.edgeAndCircle,e.polygonAndCircle,e.chainAndCircle],[e.edgeAndCircle,e.notSupported,e.edgeAndCircle,e.notSupported],[e.polygonAndCircle,e.edgeAndPolygon,e.polygon,e.chainAndPolygon],[e.chainAndCircle,e.notSupported,e.chainAndPolygon,e.notSupported]],i}();t.Contact=i;var o=function(){return function(){}}();t.ContactEdge=o}(physics||(physics={})),function(t){var e=function(){return function(){}}();t.VelocityConstraintPoint=e;var i=function(){return function(){this.points=[]}}();t.ContactVelocityConstraint=i;var o=function(){function t(){}return t.prototype.reset=function(t,e,i,o,n){this._step=t,this._count=e,this._positions=o,this._velocities=n,this._contacts=i},t}();t.ContactSolver=o}(physics||(physics={})),function(t){var e;!function(t){t[t.unknown=0]="unknown",t[t.revolute=1]="revolute",t[t.prismatic=2]="prismatic",t[t.distance=3]="distance",t[t.pulley=4]="pulley",t[t.gear=5]="gear",t[t.wheel=6]="wheel",t[t.weld=7]="weld",t[t.friction=8]="friction",t[t.rope=9]="rope",t[t.motor=10]="motor",t[t.angle=11]="angle",t[t.fixedMouse=12]="fixedMouse"}(e=t.JointType||(t.JointType={})),function(t){t[t.inactive=0]="inactive",t[t.atLower=1]="atLower",t[t.atUpper=2]="atUpper",t[t.equal=3]="equal"}(t.LimitState||(t.LimitState={}));var i=function(){return function(){}}();t.JointEdge=i;var o=function(){function t(t,e){this.enabled=!0,this.edgeA=new i,this.edgeB=new i,t&&e?(console.assert(t!=e),this.bodyA=t,this.bodyB=e):t&&(this.bodyA=t),this.breakpoint=Number.MAX_VALUE,this.collideConnected=!1}return Object.defineProperty(t.prototype,"breakpoint",{get:function(){return this._breakpoint},set:function(t){this._breakpoint=t,this._breakpointSquared=this._breakpoint*this._breakpoint},enumerable:!0,configurable:!0}),t.prototype.wakeBodies=function(){null!=this.bodyA&&(this.bodyA.isAwake=!0),null!=this.bodyB&&(this.bodyB.isAwake=!0)},t.prototype.isFixedType=function(){return this.jointType==e.fixedMouse||this.bodyA.isStatic||this.bodyB.isStatic},t}();t.Joint=o}(physics||(physics={})),function(t){var e=function(e){function i(i){void 0===i&&(i=new es.Vector2(0,9.82));var o=e.call(this)||this;return o.world=new t.World(i),o}return __extends(i,e),i.prototype.onEnabled=function(){this.world.enabled=!0},i.prototype.onDisabled=function(){this.world.enabled=!1},i.prototype.onRemovedFromScene=function(){this.world.clear(),this.world=null},i.prototype.update=function(){this.world.step(es.Time.deltaTime)},i}(es.SceneComponent);t.FSWorld=e}(physics||(physics={})),function(t){var e=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i._bodyDef=new t.FSBodyDef,i._joints=[],i}return __extends(i,e),i.prototype.update=function(){},i}(es.Component);t.FSRigidBody=e}(physics||(physics={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(es.Component);t.FSJoint=e}(physics||(physics={})),function(t){var e=function(){return function(){this.bodyType=t.BodyType.static,this.angularVelocity=0,this.linearDamping=0,this.angularDampint=0,this.isSleepingAllowed=!0,this.isAwake=!0,this.gravityScale=1,this.mass=0,this.inertia=0}}();t.FSBodyDef=e}(physics||(physics={}));